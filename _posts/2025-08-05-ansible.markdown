---
layout: post
title:  "ansible tutorials "
date:   2025-08-05 22:00:00 +0800
categories: ansible
---

## 1. Control node generate SSH key pair

```bash
ssh-keygen -t ed25519 -C "ansible-control"
```

## 2. Managed nodes add ansible user

``` bash

# Create ansible user
chattr -i /etc/passwd
useradd -m -d /home/ansible -s /bin/bash ansible
echo "ansible ALL=(ALL) NOPASSWD: ALL" > "/etc/sudoers.d/ansible"
chmod 440 /etc/sudoers.d/ansible

# Copy the control node's public key to the managed nodes
mkdir -p /home/ansible/.ssh
chown -R ansible:ansible /home/ansible/.ssh
chmod 700 /home/ansible/.ssh
touch authorized_keys
chmod 600 /home/ansible/.ssh/authorized_keys

```

## 3. Playbook

Use ansible-playbook command.

```bash
ansible-playbook -i inventory.ini change_bcadmin_password.yml --ask-vault-pass
```

### 1. Change password palybook

First, you shold generate a new password by openssl

```bash
openssl passwd -6 'newpassword'
```

```yml
---
- name: Change password for bcadmin user
  hosts: all
  become: true

  vars:
    bcadmin_password: "put your new password which generated by openssl"

  tasks:
    - name: Set password for bcadmin user
      user:
        name: bcadmin
        password: "{{ bcadmin_password }}"

```
